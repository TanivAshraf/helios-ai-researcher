# --- .github/workflows/run_research.yml (FINAL ROBUST VERSION) ---

name: Run Helios Research Agent

on:
  repository_dispatch:
    types: [run-helios-research]

jobs:
  research:
    runs-on: ubuntu-latest
    steps:
      # We must check out the repository to get access to our script files
      - name: Checkout Repository Code
        uses: actions/checkout@v4

      - name: Run Research Script
        # Securely pass the secret API key to the script's environment
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        # This simple, single line executes our script.
        # 'bash' tells the runner to use the bash interpreter.
        # The second part is the path to the script.
        # The third part is the topic data, passed as an argument.
        run: bash .github/entrypoint.sh "${{ github.event.client_payload.topic }}"
